<map name="carteSuisseCantons">
    <area shape="poly"
          coords="92,178,109,177,127,164,132,178,164,154,174,144,162,132,149,140,147,129,138,129,123,141,124,151,105,158,95,158,93,177"
          href="#canton1"> <!-- Neuchâtel -->
    <area shape="poly"
          coords="66,270,52,262,55,258,46,250,52,232,57,227,52,222,75,202,88,193,94,192,91,185,92,178,108,177,127,164,132,178,164,155,174,165,167,177,163,170,159,165,134,185,137,190,139,194,139,200,149,202,150,187,153,174,160,175,159,185,152,194,153,200,151,207,136,216,136,228,144,228,145,225,148,228,144,231,138,235,142,243,148,240,153,240,156,244,156,250,157,253,165,249,168,246,174,245,182,237,184,234,187,234,188,244,180,255,184,264,184,274,180,283,179,286,160,293,147,260,134,256,124,252,110,252,79,255,69,264,66,270"
          href="#canton2"> <!-- Vaud -->
    <area shape="poly"
          coords="53,263,65,270,66,280,70,280,75,282,57,298,51,299,43,299,37,302,30,298,34,279,51,276,52,263"
          href="#canton3"> <!-- Genève -->
    <area shape="poly"
          coords="147,261,147,261,161,294,178,287,192,269,229,263,239,254,247,258,268,249,281,234,290,234,296,242,320,235,327,221,327,233,334,237,301,282,288,285,301,303,292,314,284,314,281,315,280,326,273,332,264,332,260,342,241,341,221,333,209,346,189,348,171,361,158,345,155,328,149,316,141,322,141,302,132,300,139,274,130,267,136,257,146,261,149,261"
          href="#canton4"> <!-- Valais -->
    <area shape="poly"
          coords="152,174,148,201,140,201,139,192,134,185,159,165,167,177,175,165,168,157,180,159,187,155,183,172,199,174,202,177,195,206,206,209,206,213,198,216,197,228,187,234,181,238,173,244,166,248,158,253,156,250,156,243,153,239,146,239,141,243,139,235,147,228,146,225,142,227,136,228,135,216,152,207,154,199,153,193,160,185,160,175"
          href="#canton5"> <!-- Fribourg -->
    <area shape="poly"
          coords="459,111,467,116,462,122,462,147,462,155,465,169,459,172,458,181,451,184,425,178,424,158,416,159,415,151,419,144,417,139,403,138,397,133,400,130,397,122,381,123,377,118,372,118,375,115,382,117,398,105,390,95,398,82,407,82,405,74,419,70,424,76,431,76,436,69,447,74,455,68,480,82,479,99,467,115,459,111,459,95,471,90,474,82,467,81,453,83,447,90,440,87,426,90,423,114,438,117,445,120"
          href="#canton6"> <!-- St-Gallen -->
    <area shape="poly" coords="336,137,341,137,344,145,360,142,362,134,359,127,349,119,336,120,333,116,332,136,336,137"
          href="#canton7"> <!-- Zug -->
    <area shape="poly"
          coords="139,127,157,110,158,101,171,97,171,92,168,90,152,89,151,87,156,80,162,72,162,64,170,66,175,67,181,67,184,65,191,66,189,73,188,76,191,77,195,77,199,81,205,80,219,93,226,93,226,99,225,101,209,100,201,104,183,106,180,113,170,112,161,124,146,128,139,127"
          href="#canton9"> <!-- Jura -->
    <area shape="poly"
          coords="147,128,161,124,169,113,180,112,184,105,202,104,211,99,227,101,228,106,222,111,211,116,207,119,209,127,220,122,222,126,214,130,209,136,216,141,226,128,242,125,234,115,234,110,241,108,249,110,255,112,259,112,264,122,267,126,267,139,267,145,265,148,268,153,271,157,274,157,270,169,265,169,263,181,278,194,286,194,328,194,334,198,333,215,328,215,326,222,319,235,296,241,288,234,281,234,268,249,247,258,239,253,229,262,192,268,180,284,184,273,184,264,181,254,188,245,189,234,197,227,198,216,207,213,206,209,195,205,202,176,199,174,184,172,188,153,180,159,167,157,164,154,174,144,162,132,149,139,146,127,146,127"
          href="#canton10"> <!-- Berne -->
    <area shape="poly"
          coords="215,89,218,85,225,88,235,82,239,79,237,72,240,71,243,74,243,81,239,87,235,89,238,93,243,92,246,91,254,99,261,96,265,89,273,87,275,87,278,77,280,79,280,87,283,90,277,101,271,101,264,107,257,112,242,108,233,109,234,113,241,125,227,127,216,142,210,137,214,130,222,125,221,123,209,127,207,117,223,110,228,106,227,99,226,92,219,92,214,89"
          href="#canton11"> <!-- Soleure -->
    <area shape="poly"
          coords="259,111,264,116,274,114,278,107,288,117,289,113,302,114,302,119,311,107,318,109,322,128,333,136,337,138,331,142,329,143,324,154,314,165,299,165,301,170,290,178,287,193,278,194,263,180,265,169,271,168,274,157,268,154,265,147,266,143,267,125,260,112"
          href="#canton12"> <!-- Lucerne -->
    <area shape="poly"
          coords="240,50,245,62,261,69,265,65,279,76,280,79,281,87,283,91,277,101,272,101,258,111,265,117,274,114,279,107,288,117,288,112,303,114,303,119,311,106,318,109,322,127,332,135,333,118,331,108,337,103,327,89,327,73,324,69,336,58,324,55,312,48,304,49,294,57,276,58,271,53,261,52,258,58,248,61,250,54,247,48,242,48"
          href="#canton13"> <!-- Argovie -->
    <area shape="poly"
          coords="390,43,412,43,434,49,455,67,447,74,435,68,431,75,421,75,418,71,404,74,406,82,399,83,390,95,386,91,389,83,385,77,386,69,379,63,382,61,378,56,370,56,369,51,374,54,379,50,378,44,365,44,358,42,371,37,385,41"
          href="#canton14"> <!-- Turgovie -->
    <area shape="poly"
          coords="336,58,340,52,347,50,351,53,353,53,358,41,366,45,377,44,379,50,374,54,369,51,369,54,371,56,378,56,382,60,379,64,385,69,385,77,389,83,387,92,398,105,382,117,375,116,365,122,345,112,344,97,347,99,349,111,359,119,364,122,359,127,349,119,336,120,333,115,331,108,337,103,327,87,327,72,324,69,334,60"
          href="#canton15"> <!-- Zurich -->
    <area shape="poly"
          coords="359,127,372,117,377,119,382,123,396,123,401,130,393,139,391,152,386,155,391,159,394,168,389,173,383,176,375,174,375,167,364,174,355,168,345,165,332,160,337,159,324,157,320,164,316,164,324,155,328,142,338,137,341,137,345,145,360,142,362,133"
          href="#canton16"> <!-- Schwytz -->
    <area shape="poly"
          coords="389,174,391,181,383,185,383,191,389,194,398,194,404,189,404,185,413,185,421,186,426,179,424,158,416,160,415,152,419,143,416,139,403,139,399,134,394,138,391,152,386,155,391,159,394,168,389,173,391,180"
          href="#canton17"> <!-- Glaris -->
    <area shape="poly"
          coords="334,237,338,238,342,230,351,233,359,231,359,221,357,218,360,213,376,206,381,197,387,193,382,190,383,185,391,180,389,174,383,176,375,174,375,168,363,174,353,168,345,165,344,170,337,174,335,181,338,184,339,198,334,198,333,215,328,214,326,233"
          href="#canton18"> <!-- Uri -->
    <area shape="poly" coords="245,63,239,48,225,48,227,58,228,62,241,66,244,63" href="#canton19"> <!-- Bâle ville -->
    <area shape="poly"
          coords="314,164,318,171,319,179,321,191,328,192,329,182,336,181,339,184,338,198,335,198,328,193,286,193,290,177,301,170,299,165,315,165,314,166"
          href="#canton20"> <!-- Obwald -->
    <area shape="poly"
          coords="314,165,320,163,324,157,336,159,331,160,345,165,343,171,337,174,335,178,335,181,329,182,328,192,321,191,318,170"
          href="#canton21"> <!-- Nidwald -->
    <area shape="poly" coords="343,50,360,41,371,37,390,43,394,36,361,15,329,28,329,43,342,50" href="#canton22">
    <!-- Schaffouse -->
    <area shape="poly"
          coords="462,149,469,152,481,148,499,158,505,157,506,172,525,186,543,181,544,174,555,170,556,166,562,160,577,168,573,184,572,186,573,193,569,198,571,207,565,213,568,221,576,222,579,226,577,246,572,247,564,241,558,243,548,234,552,228,550,226,529,230,529,237,523,247,527,260,538,258,541,269,533,275,540,286,538,295,531,299,524,297,521,288,513,285,511,271,485,278,472,289,457,283,456,272,451,266,451,254,443,252,439,249,432,253,434,267,434,286,417,304,404,293,406,286,405,280,406,272,411,265,407,250,401,247,403,228,392,222,385,225,385,230,374,232,367,229,360,230,361,222,357,218,359,213,377,206,379,197,385,193,389,196,398,195,404,190,404,185,421,185,427,179,452,184,458,181,459,172,466,169,462,155"
          href="#canton23"> <!-- Grison -->
    <area shape="poly"
          coords="422,114,428,89,440,87,446,91,454,83,469,81,474,82,469,90,462,92,459,94,451,94,440,101,439,110,440,117"
          href="#canton24"> <!-- Appenzel rodes exterieures -->
    <area shape="poly" coords="459,96,460,111,447,120,439,117,441,102,452,93,459,95" href="#canton25">
    <!-- Appenzel rodes intérieures -->
    <area shape="poly"
          coords="419,305,407,315,407,323,403,325,403,335,399,337,409,350,399,365,396,366,392,364,387,366,386,363,387,357,384,339,370,333,380,322,375,317,348,314,341,297,336,296,324,285,331,273,333,253,322,255,333,238,338,238,342,231,353,233,366,230,374,233,386,230,386,225,392,222,402,228,402,246,407,250,412,265,406,271,405,281,407,285,404,294,414,303"
          href="#canton26"> <!-- Tessin -->
    <area shape="poly"
          coords="229,62,240,66,246,63,260,69,266,66,279,77,275,86,265,88,261,95,255,100,246,91,238,93,235,89,241,85,244,76,241,72,238,71,239,77,237,82,224,87,216,86,214,89,207,81,221,70"
          href="#canton27"> <!-- Bâle campagne -->
</map>

<?php
echo "<img class='swissMap' src='" . VAR_IMAGE_CARTE_SUISSE . "' alt='carte de la suisse' border='0' usemap='#carteSuisseCantons' />";

$requeteSQL =
    "SELECT p.`nom`, p.`prenom`, p.`adresse` AS adressePresident, cl.`adresse` AS adresseClub, p.`npa` AS npaPresident,
			cl.`npa` AS npaClub, p.`ville` AS villePresident, cl.`ville` AS villeClub, p.`email` AS emailPresident,
			cl.`email` AS emailClub, cl.`url`, cl.`facebookUsername`, cl.`twitterUsername`,
			p.`telPrive` AS telephonePresident, cl.`telephone` AS telephoneClub, p.`portable` AS portablePresident,
			cl.`id` AS idClub, cl.`club`, cl.`nomComplet` AS nomClub, cl.`canton`,
			ca.`nomCanton{$_SESSION["__langue__"]}` AS nomCanton
	FROM `DBDPersonne` p, `ClubsFstb` cl, `Canton` ca
	WHERE cl.`idPresident`=p.`idDbdPersonne`
		AND cl.`canton`=ca.`id`
		AND (cl.`statusId`=1 OR cl.`statusId`=2)
	ORDER BY nomCanton, cl.`club`";
$recordset = mysql_query($requeteSQL) or die ("<H1>mauvaise requete</H1>");

echo "<p>";
printf(VAR_LANG_NB_CLUBS, mysql_num_rows($recordset));
echo "</p>";

$canton = "";
$nbFois = 0;
while ($record = mysql_fetch_array($recordset)) {

    if ($canton != $record["nomCanton"]) {
        echo "<h2 id='canton" . $record["canton"] . "' class='alt'>" . $record["nomCanton"] . "</h2>";
    }

    echo "<div class='club'>";
    if (file_exists($_SERVER["DOCUMENT_ROOT"] . VAR_IMAGE_LOGO_CLUBS . "" . $record["idClub"] . ".png")) {
        $idLogo = $record["idClub"];
    } else {
        $idLogo = 0;
    }
    echo "<h3>" . $record["club"] . "</h3>";
    echo '<div class="contactInformation">';
    echo $record['nomClub'] . "<br />";
    if (strlen($record["npaClub"]) == 4 && strlen($record["villeClub"]) >= 3) {
        echo $record["adresseClub"] != null ? $record["adresseClub"] . "<br>" : "";
        echo $record["npaClub"] . "&nbsp;" . $record["villeClub"] . "<br /><br />";
    } else {
        echo stripslashes($record["prenom"]) . "&nbsp;" . stripslashes($record["nom"]) . "<br />";
        echo $record["adressePresident"] . "<br>";
        echo $record["npaPresident"] . "&nbsp;" . $record["villePresident"] . "<br /><br />";
    }
    if ($record['emailClub'] != "") {
        echo email($record["emailClub"]);
    } else if ($record["emailPresident"] != "") {
        echo email($record["emailPresident"]);
    }
    echo "<br />";
    if ($record['telephoneClub'] != "") {
        echo "<a class='phone sideIcon' href='tel:" . formatPhoneNumber($record["telephoneClub"]) . "'>" . $record['telephoneClub'] . "</a><br />";
    } else {
        if ($record["telephonePresident"] != "") {
            echo "<a class='phone sideIcon' href='tel:" . formatPhoneNumber($record["telephonePresident"]) . "'>" . $record["telephonePresident"] . "</a><br />";
        }
        if ($record["portablePresident"] != "") {
            echo "<a class='mobile sideIcon' href='tel:" . formatPhoneNumber($record["portablePresident"]) . "'>" . $record["portablePresident"] . "</a><br />";
        }
    }

    // lien sur le site du club
    if ($record["url"] != "") {
        echo "<a class='website sideIcon' href='" . addhttp($record["url"]) . "' target='_blank'>" . $record["url"] . "</a><br />";
    }
    if ($record["facebookUsername"] != "") {
        echo "<a class='facebook sideIcon' href='" . addhttp("facebook.com/" . $record["facebookUsername"]) . "' target='_blank'>" . $record["facebookUsername"] . "</a><br />";
    }
    if ($record["twitterUsername"] != "") {
        echo "<a class='twitter sideIcon' href='" . addhttp("twitter.com/" . $record["twitterUsername"]) . "' target='_blank'>@" . $record["twitterUsername"] . "</a><br />";
    }
    echo '</div>';
    echo "<img class='logoClub' src='" . VAR_IMAGE_LOGO_CLUBS . "" . $idLogo . ".png' />";
    echo "</div>";
    $canton = $record["nomCanton"];
}

// fin du tableau
echo "</div>";

?>
